import pyodbc
import datetime

server = 'md2c0gdc' 
database = 'HSKA_Anlagenschema' 
username = 'sa' 
password = 'KWmz6QOHDPLIPqzJD9t2' 
cnxn = pyodbc.connect('DRIVER={ODBC Driver 17 for SQL Server};SERVER='+server+';DATABASE='+database+';UID='+username+';PWD='+ password)
cursor = cnxn.cursor()

# read all data from DB ordered by time
start=datetime.datetime.now()
cursor.execute("""SELECT MAX([Id]) as MaxID
	,MAX([LI10002/MonAnalog.PV_Out#Value])
      ,MAX([YC10001/Valve$Analog.MV#Value])
      ,MAX([PI12002/MonAnalog.PV_Out#Value])
      ,MAX([PL1200/CM.siP_Out#Value])
      ,MAX([PL1100/CM.siP_Out#Value])
      ,MAX([PI12003/MonAnalog.PV_Out#Value])
      ,MAX([PDI14014/MonAnalog.PV_Out#Value])
      ,MAX([YC14001/Valve$Analog.MV#Value])
      ,MAX([FIC14002/PID.MV#Value])
      ,MAX([FIC14002/PID.PV_Out#Value])
      ,MAX([FIC14002/PID.SP#Value])
      ,MAX([PI14013/MonAnalog.PV_Out#Value])
      ,MAX([YC14006/Valve$Analog.MV#Value])
      ,MAX([PDIC14010/PID.MV#Value])
      ,MAX([PDIC14010/PID.PV_Out#Value])
      ,MAX([PDIC14010/PID.SP#Value])
      ,MAX([PI14012/MonAnalog.PV_Out#Value])
      ,MAX([YC23001/Valve$Analog.MV#Value])
      ,MAX([YC22001/Valve$Analog.MV#Value])
      ,MAX([YC21001/Valve$Analog.MV#Value])
      ,MAX([FIC23002/PID.PV_Out#Value])
      ,MAX([FIC23002/PID.MV#Value])
      ,MAX([FIC23002/PID.SP#Value])
      ,MAX([FIC22002/PID.MV#Value])
      ,MAX([FIC22002/PID.PV_Out#Value])
      ,MAX([FIC22002/PID.SP#Value])
      ,MAX([FIC21002/PID.MV#Value])
      ,MAX([FIC21002/PID.PV_Out#Value])
      ,MAX([FIC21002/PID.SP#Value])
      ,MAX([YS23004/Valve.Ctrl#Value])
      ,MAX([YS22004/Valve.Ctrl#Value])
      ,MAX([YS21004/Valve.Ctrl#Value])
      ,MAX([LIC23002/PID.MV#Value])
      ,MAX([LIC23002/PID.PV_Out#Value])
      ,MAX([LIC23002/PID.SP#Value])
      ,MAX([LIC22002/PID.MV#Value])
      ,MAX([LIC22002/PID.PV_Out#Value])
      ,MAX([LIC22002/PID.SP#Value])
      ,MAX([LIC21002/PID.MV#Value])
      ,MAX([LIC21002/PID.PV_Out#Value])
      ,MAX([LIC21002/PID.SP#Value])
      ,MAX([YC23006/Valve$Analog.MV#Value])
      ,MAX([YC22006/Valve$Analog.MV#Value])
      ,MAX([YC21006/Valve$Analog.MV#Value])
      ,MAX([PL2350/DriveSpeedContr.RbkOut#Value])
      ,MAX([PL2350/DriveSpeedContr.FbkFwdOut#Value])
      ,MAX([PL2350/DriveSpeedContr.FbkRevOut#Value])
      ,MAX([PL2250/DriveSpeedContr.RbkOut#Value])
      ,MAX([PL2250/DriveSpeedContr.FbkFwdOut#Value])
      ,MAX([PL2250/DriveSpeedContr.FbkRevOut#Value])
      ,MAX([PL2150/DriveSpeedContr.RbkOut#Value])
      ,MAX([PL2150/DriveSpeedContr.FbkFwdOut#Value])
      ,MAX([PL2150/DriveSpeedContr.FbkRevOut#Value])
      ,MAX([YS23012/Vlv2WayL.CtrlV0#Value])
      ,MAX([YS23012/Vlv2WayL.CtrlV1#Value])
      ,MAX([YS23012/Vlv2WayL.CtrlV2#Value])
      ,MAX([YS22012/Vlv2WayL.CtrlV0#Value])
      ,MAX([YS22012/Vlv2WayL.CtrlV1#Value])
      ,MAX([YS22012/Vlv2WayL.CtrlV2#Value])
      ,MAX([YS21012/Vlv2WayL.CtrlV0#Value])
      ,MAX([YS14004/Valve.Ctrl#Value])
      ,MAX([PIC14007/PID.MV#Value])
      ,MAX([PIC14007/PID.PV_Out#Value])
      ,MAX([PIC14007/PID.SP#Value])
      ,MAX([YC14008/Valve$Analog.Ctrl#Value])
      ,MAX([PI10003/MonAnalog.PV_Out#Value])
      ,MAX([YS10004/Valve.Ctrl#Value])
      ,MAX([DeviationID/DeviationID.PV#Value])
      ,MAX([YS10008/Valve.Ctrl#Value])
      ,MAX([YS11004/Valve.Ctrl#Value])
      ,MAX([YS14010/Valve.Ctrl#Value])
      ,MAX([YS14011/Valve.Ctrl#Value])
      ,MAX([YS14003/Valve.Ctrl#Value])
      ,MAX([YS14005/Valve.Ctrl#Value])
      ,MAX([FIC33004/FI.PV_Out#Value])
      ,MAX([YS21012/Vlv2WayL.CtrlV1#Value])
      ,MAX([YS21012/Vlv2WayL.CtrlV2#Value])
  FROM [HKA_SmA].[dbo].[timeseries_SmAKheDreiTankAllVariables]""")
row=cursor.fetchall()
for rr in row:
    for r in rr:
        print(r)
end=datetime.datetime.now()
print('Elapsed: {}'.format(end-start))
print('Done')
